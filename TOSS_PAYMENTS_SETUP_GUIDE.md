# 토스페이먼츠 설정 가이드

## 1. 토스페이먼츠 계정 생성 및 설정

### 1.1 계정 생성

1. [토스페이먼츠 개발자센터](https://developers.tosspayments.com/) 방문
2. "시작하기" 클릭하여 계정 생성
3. 이메일 인증 및 사업자 정보 입력

### 1.2 테스트 키 발급

1. 개발자센터 로그인 후 대시보드 접속
2. "내 애플리케이션" → "테스트" 탭 클릭
3. 다음 키들 복사:
   - **클라이언트 키** (test*ck*...)
   - **시크릿 키** (test*sk*...)

### 1.3 환경 변수 설정

`.env.local` 파일에 다음 내용 추가:

```bash
# 토스페이먼츠 설정
NEXT_PUBLIC_TOSS_CLIENT_KEY=test_ck_your_actual_key_here
TOSS_SECRET_KEY=test_sk_your_actual_key_here
```

## 2. 결제 상품 설정

### 2.1 상품 정보

- **상품명**: "한줄일기 Premium"
- **가격**: 1900원
- **설명**: "광고 제거 및 프리미엄 기능"

## 3. 웹훅 설정

### 3.1 웹훅 URL 등록

1. 개발자센터 → "웹훅" 메뉴
2. "웹훅 URL 추가" 클릭
3. URL 입력: `http://localhost:3001/api/payment/toss-webhook`
4. 이벤트 선택:
   - `PAYMENT_STATUS_CHANGED`
   - `PAYMENT_CONFIRMED`

## 4. 테스트 카드 번호

### 4.1 성공 테스트 카드

- **카드 번호**: 4242 4242 4242 4242
- **만료일**: 12/25
- **CVC**: 123
- **비밀번호**: 12

### 4.2 실패 테스트 카드

- **카드 번호**: 4000 0000 0000 0002 (거부됨)
- **카드 번호**: 4000 0000 0000 9995 (잔액 부족)

## 5. 개발 서버 재시작

환경 변수 변경 후 개발 서버 재시작:

```bash
npm run dev
```

## 6. 테스트 방법

1. 브라우저에서 `http://localhost:3001/payment` 접속
2. "Premium 구독하기" 버튼 클릭
3. 토스페이먼츠 결제 위젯에서 테스트 카드 정보 입력
4. 결제 완료 후 성공 페이지 확인

## 7. 문제 해결

### 7.1 일반적인 오류

- **클라이언트 키 오류**: 환경 변수 확인
- **CORS 오류**: Next.js 설정 확인
- **웹훅 오류**: 엔드포인트 URL 확인

### 7.2 로그 확인

브라우저 개발자 도구 콘솔에서 오류 메시지 확인

## 8. 토스페이먼츠 장점

- **한국 사용자 친화적**: 신용카드, 계좌이체, 무통장입금 지원
- **간편결제**: 카카오페이, 네이버페이, 페이코 연동
- **개발자 친화적**: 명확한 API 문서와 SDK
- **수수료**: 2.9% + 100원 (카드 결제)
- **한국어 지원**: 완벽한 한국어 문서 및 지원
